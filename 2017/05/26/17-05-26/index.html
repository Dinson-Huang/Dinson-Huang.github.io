<!doctype html>
<html lang="zh-CN">
  <head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta content="yes" name="apple-mobile-web-app-capable">
  <meta content="black" name="apple-mobile-web-app-status-bar-style">
  <meta content="telephone=no" name="format-detection">
  <meta name="keywords" content="Android,设计模式,安卓入门,安卓高级,前端,JavaScript,h5,css3,Jquery">
  <meta name="description" content="null">
  <meta name="author" content="DINSON">
 
 
<meta name="keywords" content="Python,基础,教学,Android,设计模式,安卓入门,安卓高级,前端,JavaScript,h5,css3,Jquery">


  
  <title>Python从入门到放弃（6）-- 常用模块学习</title>
  

  <link rel="alternate" href="/atom.xml" title="Android - Dinson - 酸奶布丁 - 国家一级码农" type="application/atom+xml">
  <link rel="canonical" href="http://dinson.win/2017/05/26/17-05-26/index.html">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="//at.alicdn.com/t/font_8ce77jkwodt5ipb9.css">
</head>


  <body>
    <aside class="aside">
  <nav class="aside-menu">
    <ul class="aside-list">
      
        
        <li class="aside-item"><i class="aside-menu-icon iconfont icon-home"></i><a href="/index.html" class="aside-menu-link" title="酸奶布丁">酸奶布丁</a></li>
        
      
        
        <li class="aside-item"><i class="aside-menu-icon iconfont icon-all"></i><a href="/archives/index.html" class="aside-menu-link" title="时间印记">时间印记</a></li>
        
      
        
        <li class="aside-item"><i class="aside-menu-icon iconfont icon-tag"></i><a href="/tags/index.html" class="aside-menu-link" title="分类标记">分类标记</a></li>
        
      
        
        <li class="aside-item"><i class="aside-menu-icon iconfont icon-python"></i><a href="http://dinson.win/Python/index.html" class="aside-menu-link" title="Python">Python</a></li>
        
      
        
        <li class="aside-item"><i class="aside-menu-icon iconfont icon-jinglingqiu"></i><a href="http://dinson.win/Pokemon/" class="aside-menu-link" title="口袋妖怪">口袋妖怪</a></li>
        
      
        
        <li class="aside-item"><i class="aside-menu-icon iconfont icon-me"></i><a href="/about/index.html" class="aside-menu-link" title="关于">关于</a></li>
        
      
        
        <li class="aside-item"><i class="aside-menu-icon iconfont icon-rss"></i><a href="/atom.xml" class="aside-menu-link" title="RSS">RSS</a></li>
        
      
    </ul>
  </nav>

  <article class="aside-show">
    
      <form class="search-from" id="search-from">
  <input class="search-text" id="search-text" type="text" name="searchText" value="" autocomplete="off">
  <button class="search-btn" id="search-btn" type="button"><i class="search-btn-icon iconfont icon-sousuo-sousuo"></i></button>
</form>

      <article class="search-data" id="search-data">
  <button class="search-close" id="search-close"><i class="search-close-icon iconfont icon-quxiao"></i></button>

  <div class="search-wrapper" id="search-wrapper"></div>
</article>

    
    <div class="aside-show-wrapper">
      <figure class="aside-avatar">
        <img src="/img/avatar.jpg" alt="avatar" class="aside-avatar-img">
        <figcaption class="aside-avatar-caption">
          Dinson
          
          <strong class="aside-avatar-STRONG">Android喵</strong>
          
        </figcaption>
      </figure>
      <p class="aside-show-description">面朝电脑--栀子花开</p>
      <ul class="aside-show-info" >
	  <li class="aside-show-item"><a href="https://github.com/DinsonCat" class="aside-show-link" target="_blank"><i class="aside-show-icon iconfont icon-github"></i></a></li>
        <li class="aside-show-item">
          <a href="javascript: void(0);" class="aside-show-link"   target="_blank"><i class="aside-show-icon iconfont icon-wechat"></i></a>
          <div class="aside-show-outside aside-show-outside_1">
            <img class="aside-show-IMG aside-show-IMG_1" src="/img/weixin.png" alt="微信"  >
          </div>
        </li>
        <li class="aside-show-item">
          <a href="javascript: void(0);" class="aside-show-link"   target="_blank"><i class="aside-show-icon iconfont icon-qq"></i></a>
          <div class="aside-show-outside">
            <img class="aside-show-IMG  " src="/img/qq.jpg"   alt="QQ">
          </div>
        </li>
		 
      </ul>
	
	 
    </div>
	
  </article>
</aside>


    <article class="main" id="main">
      <article class="post min-height">
  
  <header class="post-header">
    
    <h1 class="post-title">Python从入门到放弃（6）-- 常用模块学习</h1>
    <p class="post-meta">
      </span>
      
      <a href="/categories/Python从入门到放弃/" class="post-categories">Python从入门到放弃</a>
      
      
	  
	  
		<span id="busuanzi_container_page_pv"  class="post-time"><i class="post-tags-icon iconfont icon-yuedu"></i>Views <span id="busuanzi_value_page_pv"></span> Times</span>
	  
	  
    </p>
    
  </header>
  <div class="post-content"><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><blockquote>
<ol>
<li>模块介绍</li>
<li>time &amp;datetime模块</li>
<li>random模块</li>
<li>os模块</li>
<li>sys模块</li>
<li>shutil模块</li>
<li>json &amp; picle模块</li>
<li>shelve模块</li>
<li>xml处理模块</li>
<li>yaml处理模块</li>
<li>configparser模块</li>
<li>hashlib模块</li>
<li>subprocess模块</li>
<li>logging模块</li>
<li>re正则表达式模块</li>
</ol>
</blockquote>
<a id="more"></a>
<!-- 这是　　缩进-->
<h2 id="模块介绍"><a href="#模块介绍" class="headerlink" title="模块介绍"></a>模块介绍</h2><p><strong>模块，用一砣代码实现了某个功能的代码集合。</strong> </p>
<p>类似于函数式编程和面向过程编程，函数式编程则完成一个功能，其他代码用来调用即可，提供了代码的重用性和代码间的耦合。而对于一个复杂的功能来，可能需要多个函数才能完成（函数又可以在不同的.py文件中），n个 .py 文件组成的代码集合就称为模块。</p>
<p>如：os 是系统相关的模块；file是文件操作相关的模块</p>
<p>模块分为三种：</p>
<ol>
<li>自定义模块</li>
<li>开源模块</li>
<li>内置标准模块（又称标准库）</li>
</ol>
<h3 id="自定义模块"><a href="#自定义模块" class="headerlink" title="自定义模块"></a>自定义模块</h3><ol>
<li>定义模块<br>　　情景一：<br>　　<img src="http://ondlsj2sn.bkt.clouddn.com/FhjkC7doWKqBzRjAiQ0iL61BEas0.png" alt=""><br>　　情景二：<br>　　<img src="http://ondlsj2sn.bkt.clouddn.com/Fg9-5hbS_Pz62AYrHGReSSEnvcvB.png" alt=""><br>　　情景三：<br>　　<img src="http://ondlsj2sn.bkt.clouddn.com/Fhf-jo1LpUbK65vKh3LWJW-LJ0AY.png" alt=""></li>
<li>导入模块<br>Python之所以应用越来越广泛，在一定程度上也依赖于其为程序员提供了大量的模块以供使用，如果想要使用模块，则需要导入。导入模块有一下几种方法：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> <span class="built_in">module</span></div><div class="line"><span class="keyword">from</span> <span class="built_in">module</span>.xx.xx <span class="keyword">import</span> xx</div><div class="line"><span class="keyword">from</span> <span class="built_in">module</span>.xx.xx <span class="keyword">import</span> xx <span class="keyword">as</span> rename  </div><div class="line"><span class="keyword">from</span> <span class="built_in">module</span>.xx.xx <span class="keyword">import</span> *</div></pre></td></tr></table></figure>
</li>
</ol>
<p>导入模块其实就是告诉Python解释器去解释那个py文件</p>
<ul>
<li>导入一个py文件，解释器解释该py文件</li>
<li>导入一个包，解释器解释该包下的 <strong>init</strong>.py 文件<br>那么问题来了，导入模块时是根据那个路径作为基准来进行的呢？即：sys.path</li>
</ul>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">import sys</div><div class="line"><span class="function"><span class="title">print</span><span class="params">(sys.path)</span></span></div></pre></td></tr></table></figure>
<p>如果sys.path路径列表没有你想要的路径，可以通过 sys.path.append(‘路径’) 添加。<br>通过os模块可以获取各种目录，例如：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">import sys</div><div class="line">import os</div><div class="line"></div><div class="line">pre_path = os<span class="selector-class">.path</span><span class="selector-class">.abspath</span>(<span class="string">'../'</span>)</div><div class="line">sys<span class="selector-class">.path</span><span class="selector-class">.append</span>(pre_path)</div></pre></td></tr></table></figure></p>
<h3 id="开源模块"><a href="#开源模块" class="headerlink" title="开源模块"></a>开源模块</h3><p><strong>下载安装</strong>有两种方式：<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">yum </div><div class="line">pip</div><div class="line">apt-<span class="keyword">get</span></div><div class="line">...</div></pre></td></tr></table></figure></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">下载源码</div><div class="line">解压源码</div><div class="line">进入目录</div><div class="line">编译源码    python setup<span class="selector-class">.py</span> build</div><div class="line">安装源码    python setup<span class="selector-class">.py</span> install</div></pre></td></tr></table></figure>
<p>注：在使用源码安装时，需要使用到gcc编译和python开发环境，所以，需要先执行：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">yum <span class="keyword">install</span> gcc</div><div class="line">yum <span class="keyword">install</span> python-devel</div><div class="line">或</div><div class="line">apt-<span class="keyword">get</span> python-dev</div></pre></td></tr></table></figure></p>
<p>安装成功后，模块会自动安装到 sys.path 中的某个目录中，如：<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/<span class="class"><span class="keyword">lib</span>/<span class="title">python2</span>.7/<span class="title">site</span>-<span class="title">packages</span>/</span></div></pre></td></tr></table></figure></p>
<p><strong>导入模块</strong><br>　　同自定义模块中导入的方式</p>
<p><strong>模块 paramiko</strong><br>paramiko是一个用于做远程控制的模块，使用该模块可以对远程服务器进行命令或文件操作，值得一说的是，fabric和ansible内部的远程管理就是使用的paramiko来现实</p>
<ol>
<li>下载安装</li>
</ol>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip3 <span class="keyword">install</span> paramiko</div></pre></td></tr></table></figure>
<p>或<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"># pycrypto，由于 paramiko 模块内部依赖pycrypto，所以先下载安装pycrypto</div><div class="line"> </div><div class="line"># 下载安装 pycrypto</div><div class="line">wget http://<span class="keyword">files</span>.cnblogs.<span class="keyword">com</span>/<span class="keyword">files</span>/wupeiqi/pycrypto-<span class="number">2.6</span>.<span class="number">1</span>.tar.gz</div><div class="line">tar -xvf pycrypto-<span class="number">2.6</span>.<span class="number">1</span>.tar.gz</div><div class="line"><span class="keyword">cd</span> pycrypto-<span class="number">2.6</span>.<span class="number">1</span></div><div class="line"><span class="keyword">python</span> setup.<span class="keyword">py</span> build</div><div class="line"><span class="keyword">python</span> setup.<span class="keyword">py</span> install</div><div class="line"> </div><div class="line"># 进入<span class="keyword">python</span>环境，导入Crypto检查是否安装成功</div><div class="line"> </div><div class="line"># 下载安装 paramiko</div><div class="line">wget http://<span class="keyword">files</span>.cnblogs.<span class="keyword">com</span>/<span class="keyword">files</span>/wupeiqi/paramiko-<span class="number">1.10</span>.<span class="number">1</span>.tar.gz</div><div class="line">tar -xvf paramiko-<span class="number">1.10</span>.<span class="number">1</span>.tar.gz</div><div class="line"><span class="keyword">cd</span> paramiko-<span class="number">1.10</span>.<span class="number">1</span></div><div class="line"><span class="keyword">python</span> setup.<span class="keyword">py</span> build</div><div class="line"><span class="keyword">python</span> setup.<span class="keyword">py</span> install</div><div class="line"> </div><div class="line"># 进入<span class="keyword">python</span>环境，导入paramiko检查是否安装成功</div></pre></td></tr></table></figure></p>
<h2 id="time-amp-datetime模块"><a href="#time-amp-datetime模块" class="headerlink" title="time &amp; datetime模块"></a>time &amp; datetime模块</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">import time</div><div class="line"><span class="meta"></span></div><div class="line">#<span class="bash"> <span class="built_in">print</span>(time.clock()) <span class="comment">#返回处理器时间,3.3开始已废弃 , 改成了time.process_time()测量处理器运算时间,不包括sleep时间,不稳定,mac上测不出来</span></span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">print</span>(time.altzone)  <span class="comment">#返回与utc时间的时间差,以秒计算\</span></span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">print</span>(time.asctime()) <span class="comment">#返回时间格式"Tue May 26 15:09:27 2017",</span></span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">print</span>(time.localtime()) <span class="comment">#返回本地时间 的struct time对象格式</span></span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">print</span>(time.gmtime(time.time()-800000)) <span class="comment">#返回utc时间的struc时间对象格式</span></span></div><div class="line"><span class="meta"></span></div><div class="line">#<span class="bash"> <span class="built_in">print</span>(time.asctime(time.localtime())) <span class="comment">#返回时间格式"Tue May 26 15:10:33 2017",</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="built_in">print</span>(time.ctime()) <span class="comment">#返回Tue May 26 15:10:33 2017格式, 同上</span></span></div><div class="line"><span class="meta"></span></div><div class="line">#<span class="bash"> 日期字符串 转成 时间戳</span></div><div class="line"><span class="meta">#</span><span class="bash"> string_2_struct = time.strptime(<span class="string">"2017/05/26"</span>,<span class="string">"%Y/%m/%d"</span>) <span class="comment">#将 日期字符串 转成 struct时间对象格式</span></span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">print</span>(string_2_struct)</span></div><div class="line"><span class="meta"></span></div><div class="line">#<span class="bash"> struct_2_stamp = time.mktime(string_2_struct) <span class="comment">#将struct时间对象转成时间戳</span></span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">print</span>(struct_2_stamp)</span></div><div class="line"><span class="meta"></span></div><div class="line">#<span class="bash">将时间戳转为字符串格式</span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">print</span>(time.gmtime(time.time()-86640)) <span class="comment">#将utc时间戳转换成struct_time格式</span></span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">print</span>(time.strftime(<span class="string">"%Y-%m-%d %H:%M:%S"</span>,time.gmtime()) ) <span class="comment">#将utc struct_time格式转成指定的字符串格式</span></span></div><div class="line"><span class="meta"></span></div><div class="line">#<span class="bash">时间加减</span></div><div class="line">import datetime</div><div class="line"><span class="meta"></span></div><div class="line">#<span class="bash"> <span class="built_in">print</span>(datetime.datetime.now()) <span class="comment">#返回 2017-05-26 15:11:59.775367</span></span></div><div class="line"><span class="meta">#</span><span class="bash"><span class="built_in">print</span>(datetime.date.fromtimestamp(time.time()) )  <span class="comment"># 时间戳直接转成日期格式 2017-05-26</span></span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">print</span>(datetime.datetime.now() )</span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">print</span>(datetime.datetime.now() + datetime.timedelta(3)) <span class="comment">#当前时间+3天</span></span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">print</span>(datetime.datetime.now() + datetime.timedelta(-3)) <span class="comment">#当前时间-3天</span></span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">print</span>(datetime.datetime.now() + datetime.timedelta(hours=3)) <span class="comment">#当前时间+3小时</span></span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">print</span>(datetime.datetime.now() + datetime.timedelta(minutes=30)) <span class="comment">#当前时间+30分</span></span></div><div class="line"><span class="meta"></span></div><div class="line">#<span class="bash"> c_time  = datetime.datetime.now()</span></div><div class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">print</span>(c_time.replace(minute=3,hour=2)) <span class="comment">#时间替换</span></span></div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>Directive</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>%A</td>
<td>Locale’s full weekday name.</td>
</tr>
<tr>
<td>%b</td>
<td>Locale’s abbreviated month name.</td>
</tr>
<tr>
<td>%a</td>
<td>Locale’s abbreviated weekday name.</td>
</tr>
<tr>
<td>%B</td>
<td>Locale’s full month name.</td>
</tr>
<tr>
<td>%c</td>
<td>Locale’s appropriate date and time representation.</td>
</tr>
<tr>
<td>%d</td>
<td>Day of the month as a decimal number [01,31].</td>
</tr>
<tr>
<td>%H</td>
<td>Hour (24-hour clock) as a decimal number [00,23].</td>
</tr>
<tr>
<td>%I</td>
<td>Hour (12-hour clock) as a decimal number [01,12].</td>
</tr>
<tr>
<td>%j</td>
<td>Day of the year as a decimal number [001,366].</td>
</tr>
<tr>
<td>%m</td>
<td>Month as a decimal number [01,12].</td>
</tr>
<tr>
<td>%M</td>
<td>Minute as a decimal number [00,59].</td>
</tr>
<tr>
<td>%p</td>
<td>Locale’s equivalent of either AM or PM.</td>
</tr>
<tr>
<td>%S</td>
<td>Second as a decimal number [00,61].</td>
</tr>
<tr>
<td>%U</td>
<td>Week number of the year (Sunday as the first day of the week) as a decimal number [00,53]. All days in a new year preceding the first Sunday are considered to be in week 0.</td>
</tr>
<tr>
<td>%w</td>
<td>Weekday as a decimal number [0(Sunday),6].</td>
</tr>
<tr>
<td>%W</td>
<td>Week number of the year (Monday as the first day of the week) as a decimal number [00,53]. All days in a new year preceding the first Monday are considered to be in week 0.</td>
</tr>
<tr>
<td>%x</td>
<td>Locale’s appropriate date representation.</td>
</tr>
<tr>
<td>%X</td>
<td>Locale’s appropriate time representation.</td>
</tr>
<tr>
<td>%y</td>
<td>Year without century as a decimal number [00,99].</td>
</tr>
<tr>
<td>%Y</td>
<td>Year with century as a decimal number.</td>
</tr>
<tr>
<td>%z</td>
<td>Time zone offset indicating a positive or negative time difference from UTC/GMT of the form +HHMM or -HHMM, where H represents decimal hour digits and M represents decimal minute digits [-23:59, +23:59].</td>
</tr>
<tr>
<td>%Z</td>
<td>Time zone name (no characters if no time zone exists).</td>
</tr>
<tr>
<td>%%</td>
<td>A literal ‘%’ character.</td>
</tr>
</tbody>
</table>
<h2 id="random模块"><a href="#random模块" class="headerlink" title="random模块"></a>random模块</h2><p><strong>随机数</strong><br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">mport <span class="built_in">random</span></div><div class="line"><span class="built_in">print</span> <span class="built_in">random</span>.<span class="built_in">random</span>()</div><div class="line"><span class="built_in">print</span> <span class="built_in">random</span>.randint(<span class="number">1</span>,<span class="number">2</span>)</div><div class="line"><span class="built_in">print</span> <span class="built_in">random</span>.randrange(<span class="number">1</span>,<span class="number">10</span>)</div></pre></td></tr></table></figure></p>
<p><strong>生成随机验证码</strong><br><figure class="highlight processing"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> <span class="built_in">random</span></div><div class="line">checkcode = <span class="string">''</span></div><div class="line"><span class="keyword">for</span> i in range(<span class="number">4</span>):</div><div class="line">    current = <span class="built_in">random</span>.randrange(<span class="number">0</span>,<span class="number">4</span>)</div><div class="line">    <span class="keyword">if</span> current != i:</div><div class="line">        temp = chr(<span class="built_in">random</span>.randint(<span class="number">65</span>,<span class="number">90</span>))</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        temp = <span class="built_in">random</span>.randint(<span class="number">0</span>,<span class="number">9</span>)</div><div class="line">    checkcode += <span class="built_in">str</span>(temp)</div><div class="line"><span class="built_in">print</span> checkcode</div></pre></td></tr></table></figure></p>
<h2 id="OS模块"><a href="#OS模块" class="headerlink" title="OS模块　"></a>OS模块　</h2><p>提供对操作系统进行调用的接口<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">os</span>.getcwd() 获取当前工作目录，即当前python脚本工作的目录路径</div><div class="line"><span class="built_in">os</span>.chdir(<span class="string">"dirname"</span>)  改变当前脚本工作目录；相当于shell下cd</div><div class="line"><span class="built_in">os</span>.curdir  返回当前目录: (<span class="string">'.'</span>)</div><div class="line"><span class="built_in">os</span>.pardir  获取当前目录的父目录字符串名：(<span class="string">'..'</span>)</div><div class="line"><span class="built_in">os</span>.makedirs(<span class="string">'dirname1/dirname2'</span>)    可生成多层递归目录</div><div class="line"><span class="built_in">os</span>.removedirs(<span class="string">'dirname1'</span>)    若目录为空，则删除，并递归到上一级目录，如若也为空，则删除，依此类推</div><div class="line"><span class="built_in">os</span>.mkdir(<span class="string">'dirname'</span>)    生成单级目录；相当于shell中mkdir dirname</div><div class="line"><span class="built_in">os</span>.rmdir(<span class="string">'dirname'</span>)    删除单级空目录，若目录不为空则无法删除，报错；相当于shell中rmdir dirname</div><div class="line"><span class="built_in">os</span>.listdir(<span class="string">'dirname'</span>)    列出指定目录下的所有文件和子目录，包括隐藏文件，并以列表方式打印</div><div class="line"><span class="built_in">os</span>.<span class="built_in">remove</span>()  删除一个文件</div><div class="line"><span class="built_in">os</span>.<span class="built_in">rename</span>(<span class="string">"oldname"</span>,<span class="string">"newname"</span>)  重命名文件/目录</div><div class="line"><span class="built_in">os</span>.stat(<span class="string">'path/filename'</span>)  获取文件/目录信息</div><div class="line"><span class="built_in">os</span>.sep    输出操作系统特定的路径分隔符，win下为<span class="string">"\\"</span>,Linux下为<span class="string">"/"</span></div><div class="line"><span class="built_in">os</span>.linesep    输出当前平台使用的行终止符，win下为<span class="string">"\t\n"</span>,Linux下为<span class="string">"\n"</span></div><div class="line"><span class="built_in">os</span>.pathsep    输出用于分割文件路径的字符串</div><div class="line"><span class="built_in">os</span>.name    输出字符串指示当前使用平台。win-&gt;<span class="string">'nt'</span>; Linux-&gt;<span class="string">'posix'</span></div><div class="line"><span class="built_in">os</span>.system(<span class="string">"bash command"</span>)  运行shell命令，直接显示</div><div class="line"><span class="built_in">os</span>.environ  获取系统环境变量</div><div class="line"><span class="built_in">os</span>.<span class="built_in">path</span>.abspath(<span class="built_in">path</span>)  返回<span class="built_in">path</span>规范化的绝对路径</div><div class="line"><span class="built_in">os</span>.<span class="built_in">path</span>.split(<span class="built_in">path</span>)  将<span class="built_in">path</span>分割成目录和文件名二元组返回</div><div class="line"><span class="built_in">os</span>.<span class="built_in">path</span>.dirname(<span class="built_in">path</span>)  返回<span class="built_in">path</span>的目录。其实就是<span class="built_in">os</span>.<span class="built_in">path</span>.split(<span class="built_in">path</span>)的第一个元素</div><div class="line"><span class="built_in">os</span>.<span class="built_in">path</span>.basename(<span class="built_in">path</span>)  返回<span class="built_in">path</span>最后的文件名。如何<span class="built_in">path</span>以／或\结尾，那么就会返回空值。即<span class="built_in">os</span>.<span class="built_in">path</span>.split(<span class="built_in">path</span>)的第二个元素</div><div class="line"><span class="built_in">os</span>.<span class="built_in">path</span>.exists(<span class="built_in">path</span>)  如果<span class="built_in">path</span>存在，返回True；如果<span class="built_in">path</span>不存在，返回False</div><div class="line"><span class="built_in">os</span>.<span class="built_in">path</span>.isabs(<span class="built_in">path</span>)  如果<span class="built_in">path</span>是绝对路径，返回True</div><div class="line"><span class="built_in">os</span>.<span class="built_in">path</span>.isfile(<span class="built_in">path</span>)  如果<span class="built_in">path</span>是一个存在的文件，返回True。否则返回False</div><div class="line"><span class="built_in">os</span>.<span class="built_in">path</span>.isdir(<span class="built_in">path</span>)  如果<span class="built_in">path</span>是一个存在的目录，则返回True。否则返回False</div><div class="line"><span class="built_in">os</span>.<span class="built_in">path</span>.join(path1[, path2[, ...]])  将多个路径组合后返回，第一个绝对路径之前的参数将被忽略</div><div class="line"><span class="built_in">os</span>.<span class="built_in">path</span>.getatime(<span class="built_in">path</span>)  返回<span class="built_in">path</span>所指向的文件或者目录的最后存取时间</div><div class="line"><span class="built_in">os</span>.<span class="built_in">path</span>.getmtime(<span class="built_in">path</span>)  返回<span class="built_in">path</span>所指向的文件或者目录的最后修改时间</div></pre></td></tr></table></figure></p>
<h2 id="shutil模块"><a href="#shutil模块" class="headerlink" title="shutil模块"></a>shutil模块</h2><p><strong>高级的 文件、文件夹、压缩包 处理模块</strong></p>
<p><code>shutil.copyfileobj(fsrc, fdst, length)</code>将文件内容拷贝到另一个文件中，可以<br><code>shutil.copyfile(src, dst)</code>拷贝文件<br><code>shutil.copymode(src, dst)</code>仅拷贝权限。内容、组、用户均不变<br><code>shutil.copystat(src, dst)</code>拷贝状态的信息，包括：mode bits, atime, mtime, flags<br><code>shutil.copy(src, dst)</code>拷贝文件和权限<br><code>shutil.copy2(src, dst)</code>拷贝文件和状态信息<br><code>shutil.ignore_patterns(*patterns)</code><br><code>shutil.copytree(src, dst, symlinks=False, ignore=None)</code>递归的去拷贝文件<br>　　例如：copytree(source, destination, ignore=ignore_patterns(‘<em>.pyc’, ‘tmp</em>‘))<br><code>shutil.rmtree(path, ignore_errors, onerror)</code>递归的去删除文件<br><code>shutil.move(src, dst)</code>递归的去移动文件</p>
<p><code>shutil.make_archive(base_name, format,...)</code>创建压缩包并返回文件路径，例如：zip、tar</p>
<ul>
<li>base_name： 压缩包的文件名，也可以是压缩包的路径。只是文件名时，则保存至当前目录，否则保存至指定路径，<br>　　如：www                        =&gt;保存至当前路径<br>　　如：/Users/dinson/www =&gt;保存至/Users/dinson/</li>
<li>format：    压缩包种类，“zip”, “tar”, “bztar”，“gztar”</li>
<li>root_dir：    要压缩的文件夹路径（默认当前目录）</li>
<li>owner：    用户，默认当前用户</li>
<li>group：    组，默认当前组</li>
<li>logger：    用于记录日志，通常是logging.Logger对象<figure class="highlight clean"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#将 /Users/dinson/Downloads/test 下的文件打包放置当前程序目录</div><div class="line"><span class="keyword">import</span> shutil</div><div class="line">ret = shutil.make_archive(<span class="string">"wwwwwwwwww"</span>, <span class="string">'gztar'</span>, root_dir=<span class="string">'/Users/dinson/Downloads/test'</span>)</div><div class="line"> </div><div class="line">#将 /Users/dinson/Downloads/test 下的文件打包放置 /Users/dinson/目录</div><div class="line"><span class="keyword">import</span> shutil</div><div class="line">ret = shutil.make_archive(<span class="string">"/Users/dinson/wwwwwwwwww"</span>, <span class="string">'gztar'</span>, root_dir=<span class="string">'/Users/dinson/Downloads/test'</span>)</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="shutil-对压缩包的处理是调用-ZipFile-和-TarFile-两个模块来进行的，详细："><a href="#shutil-对压缩包的处理是调用-ZipFile-和-TarFile-两个模块来进行的，详细：" class="headerlink" title="shutil 对压缩包的处理是调用 ZipFile 和 TarFile 两个模块来进行的，详细："></a>shutil 对压缩包的处理是调用 ZipFile 和 TarFile 两个模块来进行的，详细：</h3><p>ZipFile:<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">import zipfile</div><div class="line"></div><div class="line"><span class="comment"># 压缩</span></div><div class="line">z = zipfile.ZipFile(<span class="string">'laxi.zip'</span>, <span class="string">'w'</span>)</div><div class="line">z.<span class="built_in">write</span>(<span class="string">'a.log'</span>)</div><div class="line">z.<span class="built_in">write</span>(<span class="string">'data.data'</span>)</div><div class="line">z.<span class="built_in">close</span>()</div><div class="line"></div><div class="line"><span class="comment"># 解压</span></div><div class="line">z = zipfile.ZipFile(<span class="string">'laxi.zip'</span>, <span class="string">'r'</span>)</div><div class="line">z.extractall()</div><div class="line">z.<span class="built_in">close</span>()</div></pre></td></tr></table></figure></p>
<p>TarFile:<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">import tarfile</div><div class="line"></div><div class="line"><span class="comment"># 压缩</span></div><div class="line">tar = tarfile.<span class="built_in">open</span>(<span class="string">'your.tar'</span>,<span class="string">'w'</span>)</div><div class="line">tar.<span class="built_in">add</span>(<span class="string">'/Users/wupeiqi/PycharmProjects/bbs2.zip'</span>, arcname=<span class="string">'bbs2.zip'</span>)</div><div class="line">tar.<span class="built_in">add</span>(<span class="string">'/Users/wupeiqi/PycharmProjects/cmdb.zip'</span>, arcname=<span class="string">'cmdb.zip'</span>)</div><div class="line">tar.<span class="built_in">close</span>()</div><div class="line"></div><div class="line"><span class="comment"># 解压</span></div><div class="line">tar = tarfile.<span class="built_in">open</span>(<span class="string">'your.tar'</span>,<span class="string">'r'</span>)</div><div class="line">tar.extractall()  <span class="comment"># 可设置解压地址</span></div><div class="line">tar.<span class="built_in">close</span>()</div></pre></td></tr></table></figure></p>
<h2 id="json-amp-pickle-模块"><a href="#json-amp-pickle-模块" class="headerlink" title="json &amp; pickle 模块"></a>json &amp; pickle 模块</h2><p><strong>用于序列化的两个模块</strong></p>
<ul>
<li>json，用于字符串 和 python数据类型间进行转换</li>
<li>pickle，用于python特有的类型 和 python的数据类型间进行转换</li>
</ul>
<p>Json模块提供了四个功能：dumps、dump、loads、load<br>pickle模块提供了四个功能：dumps、dump、loads、load<br><img src="http://ondlsj2sn.bkt.clouddn.com/FjXduLvXyf_mWqwvIBl0ms6M932P.png" alt=""></p>
<h2 id="shelve-模块"><a href="#shelve-模块" class="headerlink" title="shelve 模块"></a>shelve 模块</h2><p><strong>shelve模块是一个简单的k,v将内存数据通过文件持久化的模块，可以持久化任何pickle可支持的python数据格式</strong><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">import shelve</div><div class="line"> </div><div class="line">d = shelve.open(<span class="string">'shelve_test'</span>) <span class="comment">#打开一个文件</span></div><div class="line"> </div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span>(<span class="title">object</span>):</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>,n)</span></span>:</div><div class="line">        <span class="keyword">self</span>.n = n</div><div class="line"> </div><div class="line">t = Test(<span class="number">123</span>) </div><div class="line">t2 = Test(<span class="number">123334</span>)</div><div class="line"> </div><div class="line">name = [<span class="string">"alex"</span>,<span class="string">"rain"</span>,<span class="string">"test"</span>]</div><div class="line">d[<span class="string">"test"</span>] = name <span class="comment">#持久化列表</span></div><div class="line">d[<span class="string">"t1"</span>] = t      <span class="comment">#持久化类</span></div><div class="line">d[<span class="string">"t2"</span>] = t2</div><div class="line"> </div><div class="line">d.close()</div></pre></td></tr></table></figure></p>
<h2 id="xml处理模块"><a href="#xml处理模块" class="headerlink" title="xml处理模块"></a>xml处理模块</h2><blockquote>
<p>xml是实现不同语言或程序之间进行数据交换的协议，跟json差不多，但json使用起来更简单，不过，古时候，在json还没诞生的黑暗年代，大家只能选择用xml呀，至今很多传统公司如金融行业的很多系统的接口还主要是xml。</p>
<p>xml的格式如下，就是通过&lt;&gt;节点来区别数据结构的:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span><span class="meta">?&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">country</span> <span class="attr">name</span>=<span class="string">"Liechtenstein"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">rank</span> <span class="attr">updated</span>=<span class="string">"yes"</span>&gt;</span>2<span class="tag">&lt;/<span class="name">rank</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">year</span>&gt;</span>2008<span class="tag">&lt;/<span class="name">year</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">gdppc</span>&gt;</span>141100<span class="tag">&lt;/<span class="name">gdppc</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">neighbor</span> <span class="attr">name</span>=<span class="string">"Austria"</span> <span class="attr">direction</span>=<span class="string">"E"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">neighbor</span> <span class="attr">name</span>=<span class="string">"Switzerland"</span> <span class="attr">direction</span>=<span class="string">"W"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">country</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">country</span> <span class="attr">name</span>=<span class="string">"Singapore"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">rank</span> <span class="attr">updated</span>=<span class="string">"yes"</span>&gt;</span>5<span class="tag">&lt;/<span class="name">rank</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">year</span>&gt;</span>2011<span class="tag">&lt;/<span class="name">year</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">gdppc</span>&gt;</span>59900<span class="tag">&lt;/<span class="name">gdppc</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">neighbor</span> <span class="attr">name</span>=<span class="string">"Malaysia"</span> <span class="attr">direction</span>=<span class="string">"N"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">country</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">country</span> <span class="attr">name</span>=<span class="string">"Panama"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">rank</span> <span class="attr">updated</span>=<span class="string">"yes"</span>&gt;</span>69<span class="tag">&lt;/<span class="name">rank</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">year</span>&gt;</span>2011<span class="tag">&lt;/<span class="name">year</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">gdppc</span>&gt;</span>13600<span class="tag">&lt;/<span class="name">gdppc</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">neighbor</span> <span class="attr">name</span>=<span class="string">"Costa Rica"</span> <span class="attr">direction</span>=<span class="string">"W"</span>/&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">neighbor</span> <span class="attr">name</span>=<span class="string">"Colombia"</span> <span class="attr">direction</span>=<span class="string">"E"</span>/&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">country</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">data</span>&gt;</span></div></pre></td></tr></table></figure></p>
</blockquote>
<p>xml协议在各个语言里的都 是支持的，在python中可以用以下模块操作xml 　</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">import xml<span class="selector-class">.etree</span><span class="selector-class">.ElementTree</span> as ET</div><div class="line"> </div><div class="line">tree = ET.parse(<span class="string">"xmltest.xml"</span>)</div><div class="line">root = tree.getroot()</div><div class="line"><span class="function"><span class="title">print</span><span class="params">(root.tag)</span></span></div><div class="line"> </div><div class="line">#遍历xml文档</div><div class="line"><span class="keyword">for</span> child <span class="keyword">in</span> root:</div><div class="line">    print(child<span class="selector-class">.tag</span>, child.attrib)</div><div class="line">    <span class="keyword">for</span> <span class="selector-tag">i</span> <span class="keyword">in</span> child:</div><div class="line">        print(<span class="selector-tag">i</span><span class="selector-class">.tag</span>,<span class="selector-tag">i</span>.text)</div><div class="line"> </div><div class="line">#只遍历year 节点</div><div class="line"><span class="keyword">for</span> node <span class="keyword">in</span> root.iter(<span class="string">'year'</span>):</div><div class="line">    print(node<span class="selector-class">.tag</span>,node.text)</div></pre></td></tr></table></figure>
<h3 id="修改和删除xml文档内容"><a href="#修改和删除xml文档内容" class="headerlink" title="修改和删除xml文档内容"></a>修改和删除xml文档内容</h3><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">import xml.etree.ElementTree as ET</div><div class="line"> </div><div class="line">tree = ET.parse(<span class="string">"xmltest.xml"</span>)</div><div class="line">root = tree.getroot()</div><div class="line"> </div><div class="line"><span class="comment">#修改</span></div><div class="line">for <span class="keyword">node</span> <span class="title">in</span> root.iter('year'):</div><div class="line">    new_year = int(<span class="keyword">node</span>.<span class="title">text</span>) + <span class="number">1</span></div><div class="line">    <span class="keyword">node</span>.<span class="title">text</span> = str(new_year)</div><div class="line">    <span class="keyword">node</span>.<span class="title">set</span>(<span class="string">"updated"</span>,<span class="string">"yes"</span>)</div><div class="line"> </div><div class="line">tree.<span class="keyword">write</span>(<span class="string">"xmltest.xml"</span>)</div><div class="line"> </div><div class="line"><span class="comment">#删除node</span></div><div class="line">for country <span class="keyword">in</span> root.findall('country'):</div><div class="line">   rank = int(country.find('rank').text)</div><div class="line">   if rank &gt; <span class="number">50</span>:</div><div class="line">     root.remove(country)</div><div class="line"> </div><div class="line">tree.<span class="keyword">write</span>('output.xml')</div></pre></td></tr></table></figure>
<h3 id="自己创建xml文档"><a href="#自己创建xml文档" class="headerlink" title="自己创建xml文档"></a>自己创建xml文档</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">import xml.etree.ElementTree as ET</div><div class="line"> </div><div class="line"> </div><div class="line">new_xml = ET.Element(<span class="string">"namelist"</span>)</div><div class="line">name = ET.SubElement(new_xml,<span class="string">"name"</span>,attrib=&#123;<span class="string">"enrolled"</span>:<span class="string">"yes"</span>&#125;)</div><div class="line">age = ET.SubElement(name,<span class="string">"age"</span>,attrib=&#123;<span class="string">"checked"</span>:<span class="string">"no"</span>&#125;)</div><div class="line">sex = ET.SubElement(name,<span class="string">"sex"</span>)</div><div class="line">sex.text = '33'</div><div class="line">name2 = ET.SubElement(new_xml,<span class="string">"name"</span>,attrib=&#123;<span class="string">"enrolled"</span>:<span class="string">"no"</span>&#125;)</div><div class="line">age = ET.SubElement(name2,<span class="string">"age"</span>)</div><div class="line">age.text = '19'</div><div class="line"> </div><div class="line">et = ET.ElementTree(new_xml) <span class="comment">#生成文档对象</span></div><div class="line">et.write(<span class="string">"test.xml"</span>, encoding=<span class="string">"utf-8"</span>,xml_declaration=True)</div><div class="line"> </div><div class="line">ET.dump(new_xml) <span class="comment">#打印生成的格式</span></div></pre></td></tr></table></figure>
<h2 id="PyYAML模块"><a href="#PyYAML模块" class="headerlink" title="PyYAML模块"></a>PyYAML模块</h2><p>Python也可以很容易的处理ymal文档格式，只不过需要安装一个模块，参考文档：<a href="http://pyyaml.org/wiki/PyYAMLDocumentation" target="_blank" rel="external">http://pyyaml.org/wiki/PyYAMLDocumentation</a> </p>
<h2 id="ConfigParser模块"><a href="#ConfigParser模块" class="headerlink" title="ConfigParser模块"></a>ConfigParser模块</h2><p><strong>用于生成和修改常见配置文档，当前模块的名称在 python 3.x 版本中变更为 configparser。</strong></p>
<p>来看一个好多软件的常见文档格式如下<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="section">[DEFAULT]</span></div><div class="line"><span class="attr">ServerAliveInterval</span> = <span class="number">45</span></div><div class="line"><span class="attr">Compression</span> = <span class="literal">yes</span></div><div class="line"><span class="attr">CompressionLevel</span> = <span class="number">9</span></div><div class="line"><span class="attr">ForwardX11</span> = <span class="literal">yes</span></div><div class="line"><span class="section"> </span></div><div class="line">[bitbucket.org]</div><div class="line"><span class="attr">User</span> = hg</div><div class="line"><span class="section"> </span></div><div class="line">[topsecret.server.com]</div><div class="line"><span class="attr">Port</span> = <span class="number">50022</span></div><div class="line"><span class="attr">ForwardX11</span> = <span class="literal">no</span></div></pre></td></tr></table></figure></p>
<h3 id="生成配置文档"><a href="#生成配置文档" class="headerlink" title="生成配置文档"></a>生成配置文档</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> configparser</div><div class="line"> </div><div class="line"><span class="built_in">config</span> = configparser.ConfigParser()</div><div class="line"><span class="built_in">config</span>[<span class="string">"DEFAULT"</span>] = &#123;<span class="string">'ServerAliveInterval'</span>: <span class="string">'45'</span>,</div><div class="line">                      <span class="string">'Compression'</span>: <span class="string">'yes'</span>,</div><div class="line">                     <span class="string">'CompressionLevel'</span>: <span class="string">'9'</span>&#125;</div><div class="line"> </div><div class="line"><span class="built_in">config</span>[<span class="string">'bitbucket.org'</span>] = &#123;&#125;</div><div class="line"><span class="built_in">config</span>[<span class="string">'bitbucket.org'</span>][<span class="string">'User'</span>] = <span class="string">'hg'</span></div><div class="line"><span class="built_in">config</span>[<span class="string">'topsecret.server.com'</span>] = &#123;&#125;</div><div class="line">topsecret = <span class="built_in">config</span>[<span class="string">'topsecret.server.com'</span>]</div><div class="line">topsecret[<span class="string">'Host Port'</span>] = <span class="string">'50022'</span>     <span class="meta"># mutates the parser</span></div><div class="line">topsecret[<span class="string">'ForwardX11'</span>] = <span class="string">'no'</span>  <span class="meta"># same here</span></div><div class="line"><span class="built_in">config</span>[<span class="string">'DEFAULT'</span>][<span class="string">'ForwardX11'</span>] = <span class="string">'yes'</span></div><div class="line">with <span class="built_in">open</span>(<span class="string">'example.ini'</span>, <span class="string">'w'</span>) as configfile:</div><div class="line">   <span class="built_in">config</span>.<span class="built_in">write</span>(configfile)</div></pre></td></tr></table></figure>
<h3 id="读取配置文档"><a href="#读取配置文档" class="headerlink" title="读取配置文档"></a>读取配置文档</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;</span>&gt; import configparser</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; config = configparser.ConfigParser()</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; config.sections()</div><div class="line">[]</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; config.read(<span class="string">'example.ini'</span>)</div><div class="line">[<span class="string">'example.ini'</span>]</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; config.sections()</div><div class="line">[<span class="string">'bitbucket.org'</span>, <span class="string">'topsecret.server.com'</span>]</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; <span class="string">'bitbucket.org'</span> in config</div><div class="line">True</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; <span class="string">'bytebong.com'</span> in config</div><div class="line">False</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; config[<span class="string">'bitbucket.org'</span>][<span class="string">'User'</span>]</div><div class="line"><span class="string">'hg'</span></div><div class="line"><span class="meta">&gt;&gt;</span>&gt; config[<span class="string">'DEFAULT'</span>][<span class="string">'Compression'</span>]</div><div class="line"><span class="string">'yes'</span></div><div class="line"><span class="meta">&gt;&gt;</span>&gt; topsecret = config[<span class="string">'topsecret.server.com'</span>]</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; topsecret[<span class="string">'ForwardX11'</span>]</div><div class="line"><span class="string">'no'</span></div><div class="line"><span class="meta">&gt;&gt;</span>&gt; topsecret[<span class="string">'Port'</span>]</div><div class="line"><span class="string">'50022'</span></div><div class="line"><span class="meta">&gt;&gt;</span>&gt; for key in config[<span class="string">'bitbucket.org'</span>]: print(key)</div><div class="line">...</div><div class="line">user</div><div class="line">compressionlevel</div><div class="line">serveraliveinterval</div><div class="line">compression</div><div class="line">forwardx11</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; config[<span class="string">'bitbucket.org'</span>][<span class="string">'ForwardX11'</span>]</div><div class="line"><span class="string">'yes'</span></div></pre></td></tr></table></figure>
<h3 id="configparser增删改查语法"><a href="#configparser增删改查语法" class="headerlink" title="configparser增删改查语法"></a>configparser增删改查语法</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">[section1]</div><div class="line">k1 = v1</div><div class="line">k2:v2</div><div class="line">  </div><div class="line">[section2]</div><div class="line">k1 = v1</div><div class="line"> </div><div class="line"><span class="keyword">import</span> ConfigParser</div><div class="line">  </div><div class="line">config = ConfigParser.ConfigParser()</div><div class="line">config.read(<span class="string">'i.cfg'</span>)</div><div class="line">  </div><div class="line"># ########## 读 ##########</div><div class="line">#secs = config.sections()</div><div class="line">#print secs</div><div class="line">#options = config.options(<span class="string">'group2'</span>)</div><div class="line">#print options</div><div class="line">  </div><div class="line">#item_list = config.items(<span class="string">'group2'</span>)</div><div class="line">#print item_list</div><div class="line">  </div><div class="line">#val = config.get(<span class="string">'group1'</span>,<span class="string">'key'</span>)</div><div class="line">#val = config.getint(<span class="string">'group1'</span>,<span class="string">'key'</span>)</div><div class="line">  </div><div class="line"># ########## 改写 ##########</div><div class="line">#sec = config.remove_section(<span class="string">'group1'</span>)</div><div class="line">#config.write(open(<span class="string">'i.cfg'</span>, <span class="string">"w"</span>))</div><div class="line">  </div><div class="line">#sec = config.has_section(<span class="string">'wupeiqi'</span>)</div><div class="line">#sec = config.add_section(<span class="string">'wupeiqi'</span>)</div><div class="line">#config.write(open(<span class="string">'i.cfg'</span>, <span class="string">"w"</span>))</div><div class="line">  </div><div class="line">  </div><div class="line">#config.set(<span class="string">'group2'</span>,<span class="string">'k1'</span>,<span class="number">11111</span>)</div><div class="line">#config.write(open(<span class="string">'i.cfg'</span>, <span class="string">"w"</span>))</div><div class="line">  </div><div class="line">#config.remove_option(<span class="string">'group2'</span>,<span class="string">'age'</span>)</div><div class="line">#config.write(open(<span class="string">'i.cfg'</span>, <span class="string">"w"</span>))</div></pre></td></tr></table></figure>
<h2 id="hashlib模块"><a href="#hashlib模块" class="headerlink" title="hashlib模块　"></a>hashlib模块　</h2><p><strong>用于加密相关的操作，3.x里代替了md5模块和sha模块，主要提供 SHA1, SHA224, SHA256, SHA384, SHA512 ，MD5 算法</strong></p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> hashlib</div><div class="line"> </div><div class="line">m = hashlib.md5()</div><div class="line">m.update(b<span class="string">"Hello"</span>)</div><div class="line">m.update(b<span class="string">"It's me"</span>)</div><div class="line">print(m.digest())</div><div class="line">m.update(b<span class="string">"It's been a long time since last time we ..."</span>)</div><div class="line"> </div><div class="line">print(m.digest()) #<span class="number">2</span>进制格式hash</div><div class="line">print(len(m.hexdigest())) #<span class="number">16</span>进制格式hash</div><div class="line"></div><div class="line"># ######## md5 ########</div><div class="line"> </div><div class="line">hash = hashlib.md5()</div><div class="line">hash.update(<span class="string">'admin'</span>)</div><div class="line">print(hash.hexdigest())</div><div class="line"> </div><div class="line"># ######## sha1 ########</div><div class="line"> </div><div class="line">hash = hashlib.sha1()</div><div class="line">hash.update(<span class="string">'admin'</span>)</div><div class="line">print(hash.hexdigest())</div><div class="line"> </div><div class="line"># ######## sha256 ########</div><div class="line"> </div><div class="line">hash = hashlib.sha256()</div><div class="line">hash.update(<span class="string">'admin'</span>)</div><div class="line">print(hash.hexdigest())</div><div class="line"> </div><div class="line"> </div><div class="line"># ######## sha384 ########</div><div class="line"> </div><div class="line">hash = hashlib.sha384()</div><div class="line">hash.update(<span class="string">'admin'</span>)</div><div class="line">print(hash.hexdigest())</div><div class="line"> </div><div class="line"># ######## sha512 ########</div><div class="line"> </div><div class="line">hash = hashlib.sha512()</div><div class="line">hash.update(<span class="string">'admin'</span>)</div><div class="line">print(hash.hexdigest())</div></pre></td></tr></table></figure>
<p>还不够吊？python 还有一个 hmac 模块，它内部对我们创建 key 和 内容 再进行处理然后再加密</p>
<p>散列消息鉴别码，简称HMAC，是一种基于消息鉴别码MAC（Message Authentication Code）的鉴别机制。使用HMAC时,消息通讯的双方，通过验证消息中加入的鉴别密钥K来鉴别消息的真伪；</p>
<p>一般用于网络通信中消息加密，前提是双方先要约定好key,就像接头暗号一样，然后消息发送把用key把消息加密，接收方用key ＋ 消息明文再加密，拿加密后的值 跟 发送者的相对比是否相等，这样就能验证消息的真实性，及发送者的合法性了。<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> hmac</div><div class="line">h = hmac.<span class="keyword">new</span>(b<span class="string">'天王盖地虎'</span>, b<span class="string">'宝塔镇河妖'</span>)</div><div class="line"><span class="built_in">print</span> h.hexdigest()</div></pre></td></tr></table></figure></p>
<p>更多关于md5,sha1,sha256等介绍的文章看这里<a href="https://www.tbs-certificates.co.uk/FAQ/en/sha256.html" target="_blank" rel="external">https://www.tbs-certificates.co.uk/FAQ/en/sha256.html</a> </p>
<h2 id="Subprocess模块"><a href="#Subprocess模块" class="headerlink" title="Subprocess模块"></a>Subprocess模块</h2><p>常用subprocess方法示例<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#执行命令，返回命令执行状态 ， 0 or 非0</span></div><div class="line"><span class="meta">&gt;&gt;</span>&gt; retcode = subprocess.call([<span class="string">"ls"</span>, <span class="string">"-l"</span>])</div><div class="line"></div><div class="line"><span class="comment">#执行命令，如果命令结果为0，就正常返回，否则抛异常</span></div><div class="line"><span class="meta">&gt;&gt;</span>&gt; subprocess.check_call([<span class="string">"ls"</span>, <span class="string">"-l"</span>])</div><div class="line"><span class="number">0</span></div><div class="line"></div><div class="line"><span class="comment">#接收字符串格式命令，返回元组形式，第1个元素是执行状态，第2个是命令结果 </span></div><div class="line"><span class="meta">&gt;&gt;</span>&gt; subprocess.getstatusoutput(<span class="string">'ls /bin/ls'</span>)</div><div class="line">(<span class="number">0</span>, <span class="string">'/bin/ls'</span>)</div><div class="line"></div><div class="line"><span class="comment">#接收字符串格式命令，并返回结果</span></div><div class="line"><span class="meta">&gt;&gt;</span>&gt; subprocess.getoutput(<span class="string">'ls /bin/ls'</span>)</div><div class="line"><span class="string">'/bin/ls'</span></div><div class="line"></div><div class="line"><span class="comment">#执行命令，并返回结果，注意是返回结果，不是打印，下例结果返回给res</span></div><div class="line"><span class="meta">&gt;&gt;</span>&gt; res=subprocess.check_output([<span class="string">'ls'</span>,<span class="string">'-l'</span>])</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; res</div><div class="line">b<span class="string">'total 0\ndrwxr-xr-x 12 alex staff 408 Nov 2 11:05 OldBoyCRM\n'</span></div><div class="line"></div><div class="line"><span class="comment">#上面那些方法，底层都是封装的subprocess.Popen</span></div><div class="line">poll()</div><div class="line">Check <span class="keyword">if</span> child process has terminated. Returns returncode</div><div class="line"></div><div class="line">wait()</div><div class="line">Wait <span class="keyword">for</span> child process to terminate. Returns returncode attribute.</div><div class="line"></div><div class="line">terminate() 杀掉所启动进程</div><div class="line">communicate() 等待任务结束</div><div class="line"></div><div class="line">stdin 标准输入</div><div class="line"></div><div class="line">stdout 标准输出</div><div class="line"></div><div class="line">stderr 标准错误</div><div class="line"></div><div class="line">pid</div><div class="line">The process ID of the child process.</div><div class="line"></div><div class="line"><span class="comment">#例子</span></div><div class="line"><span class="meta">&gt;&gt;</span>&gt; p = subprocess.Popen(<span class="string">"df -h|grep disk"</span>,stdin=subprocess.PIPE,stdout=subprocess.PIPE,shell=True)</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; p.stdout.read()</div><div class="line">b<span class="string">'/dev/disk1 465Gi 64Gi 400Gi 14% 16901472 104938142 14% /\n</span></div><div class="line"></div><div class="line">&gt;&gt;&gt; subprocess.run(["ls", "-l"])  # doesn't capture output</div><div class="line">CompletedProcess(args=[<span class="string">'ls'</span>, <span class="string">'-l'</span>], returncode=<span class="number">0</span>)</div><div class="line"> </div><div class="line"><span class="meta">&gt;&gt;</span>&gt; subprocess.run(<span class="string">"exit 1"</span>, shell=True, check=True)</div><div class="line">Traceback (most recent call last):</div><div class="line">  ...</div><div class="line">subprocess.<span class="symbol">CalledProcessError:</span> Command <span class="string">'exit 1'</span> returned non-zero exit status <span class="number">1</span></div><div class="line"> </div><div class="line"><span class="meta">&gt;&gt;</span>&gt; subprocess.run([<span class="string">"ls"</span>, <span class="string">"-l"</span>, <span class="string">"/dev/null"</span>], stdout=subprocess.PIPE)</div><div class="line">CompletedProcess(args=[<span class="string">'ls'</span>, <span class="string">'-l'</span>, <span class="string">'/dev/null'</span>], returncode=<span class="number">0</span>,</div><div class="line">stdout=b<span class="string">'crw-rw-rw- 1 root root 1, 3 Jan 23 16:23 /dev/null\n'</span>)<span class="string">'</span></div></pre></td></tr></table></figure></p>
<p>调用subprocess.run(…)是推荐的常用方法，在大多数情况下能满足需求，但如果你可能需要进行一些复杂的与系统的交互的话，你还可以用subprocess.Popen(),语法如下：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">p</span> = subprocess.Popen(<span class="string">"find / -size +1000000 -exec ls -shl &#123;&#125; \;"</span>,shell=True,stdout=subprocess.PIPE)</div><div class="line"><span class="function"><span class="title">print</span><span class="params">(p.stdout.read()</span></span>)</div></pre></td></tr></table></figure></p>
<p>可用参数：</p>
<ul>
<li>args：shell命令，可以是字符串或者序列类型（如：list，元组）</li>
<li>bufsize：指定缓冲。0 无缓冲,1 行缓冲,其他 缓冲区大小,负值 系统缓冲</li>
<li>stdin, stdout, stderr：分别表示程序的标准输入、输出、错误句柄</li>
<li>preexec_fn：只在Unix平台下有效，用于指定一个可执行对象（callable object），它将在子进程运行之前被调用</li>
<li>close_sfs：在windows平台下，如果close_fds被设置为True，则新创建的子进程将不会继承父进程的输入、输出、错误管道。所以不能将close_fds设置为True同时重定向子进程的标准输入、输出与错误(stdin, stdout, stderr)。</li>
<li>shell：同上</li>
<li>cwd：用于设置子进程的当前目录</li>
<li>env：用于指定子进程的环境变量。如果env = None，子进程的环境变量将从父进程中继承。</li>
<li>universal_newlines：不同系统的换行符不同，True -&gt; 同意使用 \n</li>
<li>startupinfo与createionflags只在windows下有效<br>将被传递给底层的CreateProcess()函数，用于设置子进程的一些属性，如：主窗口的外观，进程的优先级等等</li>
</ul>
<p>终端输入的命令分为两种：</p>
<ul>
<li>输入即可得到输出，如：ifconfig</li>
<li>输入进行某环境，依赖再输入，如：python</li>
</ul>
<p>需要交互的命令示例</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">import subprocess</div><div class="line"> </div><div class="line">obj = subprocess.Popen([<span class="string">"python"</span>], stdin=subprocess<span class="selector-class">.PIPE</span>, stdout=subprocess<span class="selector-class">.PIPE</span>, stderr=subprocess.PIPE)</div><div class="line">obj<span class="selector-class">.stdin</span><span class="selector-class">.write</span>(<span class="string">'print 1 \n '</span>)</div><div class="line">obj<span class="selector-class">.stdin</span><span class="selector-class">.write</span>(<span class="string">'print 2 \n '</span>)</div><div class="line">obj<span class="selector-class">.stdin</span><span class="selector-class">.write</span>(<span class="string">'print 3 \n '</span>)</div><div class="line">obj<span class="selector-class">.stdin</span><span class="selector-class">.write</span>(<span class="string">'print 4 \n '</span>)</div><div class="line"> </div><div class="line">out_error_list = obj.communicate(timeout=<span class="number">10</span>)</div><div class="line">print out_error_list</div></pre></td></tr></table></figure>
<p><strong>subprocess实现sudo 自动输入密码</strong><br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">import subprocess</div><div class="line"> </div><div class="line">def mypass():</div><div class="line">    mypass = <span class="string">'123'</span> <span class="comment">#or get the password from anywhere</span></div><div class="line">    <span class="literal">return</span> mypass</div><div class="line"> </div><div class="line">echo = subprocess.Popen([<span class="string">'echo'</span>,mypass()],</div><div class="line">                        <span class="keyword">stdout</span>=subprocess.PIPE,</div><div class="line">                        )</div><div class="line"> </div><div class="line">sudo = subprocess.Popen([<span class="string">'sudo'</span>,<span class="string">'-S'</span>,<span class="string">'iptables'</span>,<span class="string">'-L'</span>],</div><div class="line">                        <span class="keyword">stdin</span>=echo.<span class="keyword">stdout</span>,</div><div class="line">                        <span class="keyword">stdout</span>=subprocess.PIPE,</div><div class="line">                        )</div><div class="line"> </div><div class="line">end_of_pipe = sudo.<span class="keyword">stdout</span></div><div class="line"> </div><div class="line">print <span class="string">"Password ok \n Iptables Chains %s"</span> % end_of_pipe.<span class="built_in">read</span>()</div></pre></td></tr></table></figure></p>
<h2 id="logging模块"><a href="#logging模块" class="headerlink" title="logging模块"></a>logging模块</h2><blockquote>
<p>很多程序都有记录日志的需求，并且日志中包含的信息即有正常的程序访问日志，还可能有错误、警告等信息输出，python的logging模块提供了标准的日志接口，你可以通过它存储各种格式的日志，logging的日志可以分为 debug(), info(), warning(), error() and critical() 5个级别，下面我们看一下怎么用。</p>
</blockquote>
<p>最简单用法<br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">import</span> <span class="selector-tag">logging</span></div><div class="line"> </div><div class="line"><span class="selector-tag">logging</span><span class="selector-class">.warning</span>(<span class="string">"user [alex] attempted wrong password more than 3 times"</span>)</div><div class="line"><span class="selector-tag">logging</span><span class="selector-class">.critical</span>(<span class="string">"server is down"</span>)</div><div class="line"> </div><div class="line">#输出</div><div class="line"><span class="selector-tag">WARNING</span><span class="selector-pseudo">:root</span><span class="selector-pseudo">:user</span> <span class="selector-attr">[alex]</span> <span class="selector-tag">attempted</span> <span class="selector-tag">wrong</span> <span class="selector-tag">password</span> <span class="selector-tag">more</span> <span class="selector-tag">than</span> <span class="selector-tag">3</span> <span class="selector-tag">times</span></div><div class="line"><span class="selector-tag">CRITICAL</span><span class="selector-pseudo">:root</span><span class="selector-pseudo">:server</span> <span class="selector-tag">is</span> <span class="selector-tag">down</span></div></pre></td></tr></table></figure></p>
<p>看一下这几个日志级别分别代表什么意思</p>
<table>
<thead>
<tr>
<th>Level</th>
<th>When it’s used</th>
</tr>
</thead>
<tbody>
<tr>
<td>DEBUG</td>
<td>Detailed information, typically of interest only when diagnosing problems.</td>
</tr>
<tr>
<td>INFO</td>
<td>Confirmation that things are working as expected.</td>
</tr>
<tr>
<td>WARNING</td>
<td>An indication that something unexpected happened, or indicative of some problem in the near future (e.g. ‘disk space low’). The software is still working as expected.</td>
</tr>
<tr>
<td>ERROR</td>
<td>Due to a more serious problem, the software has not been able to perform some function.</td>
</tr>
<tr>
<td>CRITICAL</td>
<td>A serious error, indicating that the program itself may be unable to continue running.</td>
</tr>
</tbody>
</table>
<p>如果想把日志写到文件里，也很简单<br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">import</span> <span class="selector-tag">logging</span></div><div class="line"> </div><div class="line"><span class="selector-tag">logging</span><span class="selector-class">.basicConfig</span>(filename=<span class="string">'example.log'</span>,level=logging.INFO)</div><div class="line"><span class="selector-tag">logging</span><span class="selector-class">.debug</span>(<span class="string">'This message should go to the log file'</span>)</div><div class="line"><span class="selector-tag">logging</span><span class="selector-class">.info</span>(<span class="string">'So should this'</span>)</div><div class="line"><span class="selector-tag">logging</span><span class="selector-class">.warning</span>(<span class="string">'And this, too'</span>)</div></pre></td></tr></table></figure></p>
<p>其中下面这句中的level=loggin.INFO意思是，把日志纪录级别设置为INFO，也就是说，只有比日志是INFO或比INFO级别更高的日志才会被纪录到文件里，在这个例子， 第一条日志是不会被纪录的，如果希望纪录debug的日志，那把日志级别改成DEBUG就行了。<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">logging.basicConfig<span class="params">(<span class="attr">filename</span>='example.log',<span class="attr">level</span>=logging.INFO)</span></div></pre></td></tr></table></figure></p>
<p>感觉上面的日志格式忘记加上时间啦，日志不知道时间怎么行呢，下面就来加上!<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> logging</div><div class="line">logging.basicConfig(format=<span class="string">'%(asctime)s %(message)s'</span>, datefmt=<span class="string">'%m/%d/%Y %I:%M:%S %p'</span>)</div><div class="line">logging.warning(<span class="string">'is when this event was logged.'</span>)</div><div class="line"> </div><div class="line"><span class="comment">#输出</span></div><div class="line"><span class="number">12</span>/<span class="number">12</span>/<span class="number">2010</span> <span class="number">11</span>:<span class="number">46</span>:<span class="number">36</span> AM <span class="keyword">is</span> <span class="keyword">when</span> <span class="keyword">this</span> event was logged.</div></pre></td></tr></table></figure></p>
<h3 id="日志格式"><a href="#日志格式" class="headerlink" title="日志格式"></a>日志格式</h3><table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>%(name)s</td>
<td>Logger的名字</td>
</tr>
<tr>
<td>%(levelno)s</td>
<td>数字形式的日志级别</td>
</tr>
<tr>
<td>%(levelname)s</td>
<td>文本形式的日志级别</td>
</tr>
<tr>
<td>%(pathname)s</td>
<td>调用日志输出函数的模块的完整路径名，可能没有</td>
</tr>
<tr>
<td>%(filename)s</td>
<td>调用日志输出函数的模块的文件名</td>
</tr>
<tr>
<td>%(module)s</td>
<td>调用日志输出函数的模块名</td>
</tr>
<tr>
<td>%(funcName)s</td>
<td>调用日志输出函数的函数名</td>
</tr>
<tr>
<td>%(lineno)d</td>
<td>调用日志输出函数的语句所在的代码行</td>
</tr>
<tr>
<td>%(created)f</td>
<td>当前时间，用UNIX标准的表示时间的浮 点数表示</td>
</tr>
<tr>
<td>%(relativeCreated)d</td>
<td>输出日志信息时的，自Logger创建以 来的毫秒数</td>
</tr>
<tr>
<td>%(asctime)s</td>
<td>字符串形式的当前时间。默认格式是 “2003-07-08 16:49:45,896”。逗号后面的是毫秒</td>
</tr>
<tr>
<td>%(thread)d</td>
<td>线程ID。可能没有</td>
</tr>
<tr>
<td>%(threadName)s</td>
<td>线程名。可能没有</td>
</tr>
<tr>
<td>%(process)d</td>
<td>进程ID。可能没有</td>
</tr>
<tr>
<td>%(message)s</td>
<td>用户输出的消息</td>
</tr>
</tbody>
</table>
<p>如果想同时把log打印在屏幕和文件日志里，就需要了解一点复杂的知识 了</p>
<p>Python 使用logging模块记录日志涉及四个主要类，使用官方文档中的概括最为合适：<br><strong>logger提供了应用程序可以直接使用的接口；</strong><br><strong>handler将(logger创建的)日志记录发送到合适的目的输出；</strong><br><strong>filter提供了细度设备来决定输出哪条日志记录；</strong><br><strong>formatter决定日志记录的最终输出格式</strong>。<br><code>logger</code><br>每个程序在输出信息之前都要获得一个Logger。Logger通常对应了程序的模块名，比如聊天工具的图形界面模块可以这样获得它的Logger：<br>LOG=logging.getLogger(”chat.gui”)<br>而核心模块可以这样：<br>LOG=logging.getLogger(”chat.kernel”)</p>
<p>Logger.setLevel(lel):指定最低的日志级别，低于lel的级别将被忽略。debug是最低的内置级别，critical为最高<br>Logger.addFilter(filt)、Logger.removeFilter(filt):添加或删除指定的filter<br>Logger.addHandler(hdlr)、Logger.removeHandler(hdlr)：增加或删除指定的handler<br>Logger.debug()、Logger.info()、Logger.warning()、Logger.error()、Logger.critical()：可以设置的日志级别</p>
<p><code>handler</code><br>handler对象负责发送相关的信息到指定目的地。Python的日志系统有多种Handler可以使用。有些Handler可以把信息输出到控制台，有些Logger可以把信息输出到文件，还有些 Handler可以把信息发送到网络上。如果觉得不够用，还可以编写自己的Handler。可以通过addHandler()方法添加多个多handler<br>Handler.setLevel(lel):指定被处理的信息级别，低于lel级别的信息将被忽略<br>Handler.setFormatter()：给这个handler选择一个格式<br>Handler.addFilter(filt)、Handler.removeFilter(filt)：新增或删除一个filter对象</p>
<p>每个Logger可以附加多个Handler。接下来我们就来介绍一些常用的Handler：<br>1) <code>logging.StreamHandler</code><br>使用这个Handler可以向类似与sys.stdout或者sys.stderr的任何文件对象(file object)输出信息。它的构造函数是：<br>StreamHandler([strm])<br>其中strm参数是一个文件对象。默认是sys.stderr</p>
<p>2) <code>logging.FileHandler</code><br>和StreamHandler类似，用于向一个文件输出日志信息。不过FileHandler会帮你打开这个文件。它的构造函数是：<br>FileHandler(filename[,mode])<br>filename是文件名，必须指定一个文件名。<br>mode是文件的打开方式。参见Python内置函数open()的用法。默认是’a’，即添加到文件末尾。</p>
<p>3) <code>logging.handlers.RotatingFileHandler</code><br>这个Handler类似于上面的FileHandler，但是它可以管理文件大小。当文件达到一定大小之后，它会自动将当前日志文件改名，然后创建 一个新的同名日志文件继续输出。比如日志文件是chat.log。当chat.log达到指定的大小之后，RotatingFileHandler自动把 文件改名为chat.log.1。不过，如果chat.log.1已经存在，会先把chat.log.1重命名为chat.log.2。。。最后重新创建 chat.log，继续输出日志信息。它的构造函数是：<br>RotatingFileHandler( filename[, mode[, maxBytes[, backupCount]]])<br>其中filename和mode两个参数和FileHandler一样。<br>maxBytes用于指定日志文件的最大文件大小。如果maxBytes为0，意味着日志文件可以无限大，这时上面描述的重命名过程就不会发生。<br>backupCount用于指定保留的备份文件的个数。比如，如果指定为2，当上面描述的重命名过程发生时，原有的chat.log.2并不会被更名，而是被删除。</p>
<p>4) <code>logging.handlers.TimedRotatingFileHandler</code><br>这个Handler和RotatingFileHandler类似，不过，它没有通过判断文件大小来决定何时重新创建日志文件，而是间隔一定时间就 自动创建新的日志文件。重命名的过程与RotatingFileHandler类似，不过新的文件不是附加数字，而是当前时间。它的构造函数是：<br>TimedRotatingFileHandler( filename [,when [,interval [,backupCount]]])<br>其中filename参数和backupCount参数和RotatingFileHandler具有相同的意义。<br>interval是时间间隔。<br>when参数是一个字符串。表示时间间隔的单位，不区分大小写。它有以下取值：<br>S 秒<br>M 分<br>H 小时<br>D 天<br>W 每星期（interval==0时代表星期一）<br>midnight 每天凌晨</p>
<p>示例<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">import logging</div><div class="line"> </div><div class="line">#create logger</div><div class="line">logger = logging.getLogger(<span class="string">'TEST-LOG'</span>)</div><div class="line">logger.setLevel(logging.DEBUG)</div><div class="line"> </div><div class="line"># create console handler <span class="built_in">and</span> <span class="keyword">set</span> level <span class="keyword">to</span> <span class="keyword">debug</span></div><div class="line">ch = logging.StreamHandler()</div><div class="line">ch.setLevel(logging.DEBUG)</div><div class="line"> </div><div class="line"># create <span class="keyword">file</span> handler <span class="built_in">and</span> <span class="keyword">set</span> level <span class="keyword">to</span> warning</div><div class="line">fh = logging.FileHandler(<span class="string">"access.log"</span>)</div><div class="line">fh.setLevel(logging.WARNING)</div><div class="line"># create formatter</div><div class="line">formatter = logging.Formatter(<span class="string">'%(asctime)s - %(name)s - %(levelname)s - %(message)s'</span>)</div><div class="line"> </div><div class="line"># <span class="built_in">add</span> formatter <span class="keyword">to</span> ch <span class="built_in">and</span> fh</div><div class="line">ch.setFormatter(formatter)</div><div class="line">fh.setFormatter(formatter)</div><div class="line"> </div><div class="line"># <span class="built_in">add</span> ch <span class="built_in">and</span> fh <span class="keyword">to</span> logger</div><div class="line">logger.addHandler(ch)</div><div class="line">logger.addHandler(fh)</div><div class="line"> </div><div class="line"># <span class="string">'application'</span> code</div><div class="line">logger.<span class="keyword">debug</span>(<span class="string">'debug message'</span>)</div><div class="line">logger.info(<span class="string">'info message'</span>)</div><div class="line">logger.warn(<span class="string">'warn message'</span>)</div><div class="line">logger.error(<span class="string">'error message'</span>)</div><div class="line">logger.critical(<span class="string">'critical message'</span>)</div></pre></td></tr></table></figure></p>
<p>文件自动截断例子<br><figure class="highlight openscad"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">import</span> logging</div><div class="line"></div><div class="line">from logging <span class="built_in">import</span> handlers</div><div class="line"></div><div class="line">logger = logging.getLogger(__name__)</div><div class="line"></div><div class="line">log_file = <span class="string">"timelog.log"</span></div><div class="line">#fh = handlers.RotatingFileHandler(filename=log_file,maxBytes=<span class="number">10</span>,backupCount=<span class="number">3</span>)</div><div class="line">fh = handlers.TimedRotatingFileHandler(filename=log_file,when=<span class="string">"S"</span>,interval=<span class="number">5</span>,backupCount=<span class="number">3</span>)</div><div class="line"></div><div class="line">formatter = logging.Formatter('%(asctime)s %(<span class="function"><span class="keyword">module</span>)<span class="title">s</span>:%<span class="params">(lineno)</span><span class="title">d</span> %<span class="params">(message)</span><span class="title">s</span>')</span></div><div class="line"></div><div class="line"><span class="title">fh</span>.<span class="title">setFormatter</span><span class="params">(formatter)</span></div><div class="line"></div><div class="line"><span class="title">logger</span>.<span class="title">addHandler</span><span class="params">(fh)</span></div><div class="line"></div><div class="line"><span class="title">logger</span>.<span class="title">warning</span><span class="params">(<span class="string">"test1"</span>)</span></div><div class="line"><span class="title">logger</span>.<span class="title">warning</span><span class="params">(<span class="string">"test12"</span>)</span></div><div class="line"><span class="title">logger</span>.<span class="title">warning</span><span class="params">(<span class="string">"test13"</span>)</span></div><div class="line"><span class="title">logger</span>.<span class="title">warning</span><span class="params">(<span class="string">"test14"</span>)</span></div></pre></td></tr></table></figure></p>
<h2 id="re模块"><a href="#re模块" class="headerlink" title="re模块"></a>re模块</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="string">'.'</span>     默认匹配除\n之外的任意一个字符，若指定flag DOTALL,则匹配任意字符，包括换行</div><div class="line"><span class="string">'^'</span>     匹配字符开头，若指定flags MULTILINE,这种也可以匹配上(<span class="string">r"^a"</span>,<span class="string">"\nabc\neee"</span>,flags=re.MULTILINE)</div><div class="line"><span class="string">'$'</span>     匹配字符结尾，或e.search(<span class="string">"foo$"</span>,<span class="string">"bfoo\nsdfsf"</span>,flags=re.MULTILINE).group()也可以</div><div class="line"><span class="string">'*'</span>     匹配*号前的字符<span class="number">0</span>次或多次，re.findall(<span class="string">"ab*"</span>,<span class="string">"cabb3abcbbac"</span>)  结果为[<span class="string">'abb'</span>, <span class="string">'ab'</span>, <span class="string">'a'</span>]</div><div class="line"><span class="string">'+'</span>     匹配前一个字符<span class="number">1</span>次或多次，re.findall(<span class="string">"ab+"</span>,<span class="string">"ab+cd+abb+bba"</span>) 结果[<span class="string">'ab'</span>, <span class="string">'abb'</span>]</div><div class="line"><span class="string">'?'</span>     匹配前一个字符<span class="number">1</span>次或<span class="number">0</span>次</div><div class="line"><span class="string">'&#123;m&#125;'</span>   匹配前一个字符m次</div><div class="line"><span class="string">'&#123;n,m&#125;'</span> 匹配前一个字符n到m次，re.findall(<span class="string">"ab&#123;1,3&#125;"</span>,<span class="string">"abb abc abbcbbb"</span>) 结果<span class="string">'abb'</span>, <span class="string">'ab'</span>, <span class="string">'abb'</span>]</div><div class="line"><span class="string">'|'</span>     匹配|左或|右的字符，re.search(<span class="string">"abc|ABC"</span>,<span class="string">"ABCBabcCD"</span>).group() 结果<span class="string">'ABC'</span></div><div class="line"><span class="string">'(...)'</span> 分组匹配，re.search(<span class="string">"(abc)&#123;2&#125;a(123|456)c"</span>, <span class="string">"abcabca456c"</span>).group() 结果 abcabca456c</div><div class="line"> </div><div class="line"> </div><div class="line"><span class="string">'\A'</span>    只从字符开头匹配，re.search(<span class="string">"\Aabc"</span>,<span class="string">"alexabc"</span>) 是匹配不到的</div><div class="line"><span class="string">'\Z'</span>    匹配字符结尾，同$</div><div class="line"><span class="string">'\d'</span>    匹配数字<span class="number">0</span>-<span class="number">9</span></div><div class="line"><span class="string">'\D'</span>    匹配非数字</div><div class="line"><span class="string">'\w'</span>    匹配[A-Za-z0-<span class="number">9</span>]</div><div class="line"><span class="string">'\W'</span>    匹配非[A-Za-z0-<span class="number">9</span>]</div><div class="line"><span class="string">'s'</span>     匹配空白字符、\t、\n、\r , re.search(<span class="string">"\s+"</span>,<span class="string">"ab\tc1\n3"</span>).group() 结果 <span class="string">'\t'</span></div><div class="line"><span class="string">'(?P&lt;name&gt;...)'</span> 分组匹配</div></pre></td></tr></table></figure>
<blockquote>
<p>re.search(“(?P<province>[0-9]{4})(?P<city>[0-9]{2})(?P<birthday>[0-9]{4})”,”371481199306143242”).groupdict(“city”) </birthday></city></province></p>
<p>结果{‘province’: ‘3714’, ‘city’: ‘81’, ‘birthday’: ‘1993’}</p>
</blockquote>
<p>最常用的匹配语法<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">re<span class="selector-class">.match</span> 从头开始匹配</div><div class="line">re<span class="selector-class">.search</span> 匹配包含</div><div class="line">re<span class="selector-class">.findall</span> 把所有匹配到的字符放到以列表中的元素返回</div><div class="line">re<span class="selector-class">.splitall</span> 以匹配到的字符当做列表分隔符</div><div class="line">re<span class="selector-class">.sub</span>      匹配字符并替换</div></pre></td></tr></table></figure></p>
<h3 id="反斜杠的困扰"><a href="#反斜杠的困扰" class="headerlink" title="反斜杠的困扰"></a>反斜杠的困扰</h3><p>与大多数编程语言相同，正则表达式里使用”\”作为转义字符，这就可能造成反斜杠困扰。假如你需要匹配文本中的字符”\”，那么使用编程语言表示的正则表达式里将需要4个反斜杠”\\“：前两个和后两个分别用于在编程语言里转义成反斜杠，转换成两个反斜杠后再在正则表达式里转义成一个反斜杠。Python里的原生字符串很好地解决了这个问题，这个例子中的正则表达式可以使用r”\“表示。同样，匹配一个数字的”\d”可以写成r”\d”。有了原生字符串，你再也不用担心是不是漏写了反斜杠，写出来的表达式也更直观。</p>
<p>仅需轻轻知道的几个匹配模式<br><figure class="highlight gcode"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">re.I<span class="comment">(re.IGNORECASE)</span>: 忽略大小写（括号内是完整写法，下同）</div><div class="line">re.M<span class="comment">(MULTILINE)</span>: 多行模式，改变<span class="string">'^'</span>和<span class="string">'$'</span>的行为（参见上图）</div><div class="line">re.S<span class="comment">(DOTALL)</span>: 点任意匹配模式，改变<span class="string">'.'</span>的行为</div></pre></td></tr></table></figure></p>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="100%" height="86" src="//music.163.com/outchain/player?type=2&id=28190709&auto=1&height=66"></iframe></div>
    
      <p class="post-copyright">转载文章请链接上原文地址：<a class="post-copyright-link" href="http://dinson.win/2017/05/26/17-05-26/" title="http://dinson.win/2017/05/26/17-05-26/" target="_blank">http://dinson.win/2017/05/26/17-05-26/</a></p>

      
      <div class="toc-wrapper">
        <div class="toc-scroll">
          <div class="toc-middle">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#概述"><span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#模块介绍"><span class="toc-text">模块介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#自定义模块"><span class="toc-text">自定义模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#开源模块"><span class="toc-text">开源模块</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#time-amp-datetime模块"><span class="toc-text">time & datetime模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#random模块"><span class="toc-text">random模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OS模块"><span class="toc-text">OS模块　</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shutil模块"><span class="toc-text">shutil模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#shutil-对压缩包的处理是调用-ZipFile-和-TarFile-两个模块来进行的，详细："><span class="toc-text">shutil 对压缩包的处理是调用 ZipFile 和 TarFile 两个模块来进行的，详细：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#json-amp-pickle-模块"><span class="toc-text">json & pickle 模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shelve-模块"><span class="toc-text">shelve 模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xml处理模块"><span class="toc-text">xml处理模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#修改和删除xml文档内容"><span class="toc-text">修改和删除xml文档内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#自己创建xml文档"><span class="toc-text">自己创建xml文档</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PyYAML模块"><span class="toc-text">PyYAML模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ConfigParser模块"><span class="toc-text">ConfigParser模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#生成配置文档"><span class="toc-text">生成配置文档</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#读取配置文档"><span class="toc-text">读取配置文档</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#configparser增删改查语法"><span class="toc-text">configparser增删改查语法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hashlib模块"><span class="toc-text">hashlib模块　</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Subprocess模块"><span class="toc-text">Subprocess模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#logging模块"><span class="toc-text">logging模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#日志格式"><span class="toc-text">日志格式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#re模块"><span class="toc-text">re模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#反斜杠的困扰"><span class="toc-text">反斜杠的困扰</span></a></li></ol></li></ol>
          </div>
        </div>
      </div>
    
  
  
 
</article>

      <footer class="footer">
  <p class="footer-text">© 2016 - 2017 ❤ Powered by - DINSON</p>
   
  <span id="busuanzi_container_site_pv"><i class="iconfont icon-dianji"></i>&nbsp;&nbsp;<span id="busuanzi_value_site_pv"></span>Times</span>
  <span style="margin: 0.5em 0.5em">|</span>
  <span id="busuanzi_container_site_uv"><i class="iconfont icon-fangke"></i>&nbsp;&nbsp;<span id="busuanzi_value_site_uv"></span>Times</span>
  <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  <p class="footer-text">一只穿着空气鞋碎花沙滩裤挂着大金链子叼着烟戴着墨镜翘着二郎腿边弹吉他边敲代码的程序猿</p>

  <script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

</footer> 
    </article>

    <script src="/js/to-top.js"></script>
    <script src="/js/search.js"></script>
  </body>
</html>
